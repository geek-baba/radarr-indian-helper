<!-- Sidebar Overlay (mobile only) -->
<div id="sidebarOverlay" class="fixed inset-0 bg-black/50 z-30 lg:hidden hidden" onclick="document.getElementById('sidebar').classList.add('-translate-x-full'); this.classList.add('hidden');"></div>

<!-- Sidebar -->
<aside id="sidebar" class="fixed left-0 top-0 h-screen w-64 bg-[var(--surface)] dark:bg-brand-surfaceDark border-r border-[var(--border)] transition-transform z-40 lg:translate-x-0 -translate-x-full">
  <div class="flex items-center justify-between px-4 h-16 border-b border-[var(--border)]">
    <%- include('logo-desiarr') %>
    <button id="collapseSidebar" class="icon-btn lg:hidden" aria-label="Collapse sidebar" type="button">
      <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
  </div>

  <nav class="mt-4 px-3 text-sm">
    <% 
      const currentPageValue = typeof currentPage !== 'undefined' ? currentPage : '';
      const isDashboardPage = currentPageValue === 'dashboard' || currentPageValue === 'movies' || currentPageValue === 'tv';
    %>
    
    <!-- Dashboard with submenu -->
    <div class="mb-1">
      <div class="flex items-center gap-3 px-3 py-2 rounded-lg transition-colors cursor-pointer dashboard-parent
                  <%= isDashboardPage 
                      ? 'bg-blue-600 text-white' 
                      : 'hover:bg-gray-100 dark:hover:bg-white/10 text-gray-700 dark:text-gray-300' %>"
           onclick="this.nextElementSibling.classList.toggle('hidden')">
        <span class="w-5 h-5 inline-block flex-shrink-0">
          <i data-icon="layout-dashboard"></i>
        </span>
        <span class="flex-1">Dashboard</span>
        <svg class="w-4 h-4 transition-transform dashboard-arrow <%= isDashboardPage ? 'rotate-90' : '' %>" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </div>
      <div class="ml-8 mt-1 space-y-1 dashboard-submenu <%= isDashboardPage ? '' : 'hidden' %>">
        <a href="/dashboard" 
           class="flex items-center gap-3 px-3 py-2 rounded-lg transition-colors
                  <%= currentPageValue === 'dashboard' 
                      ? 'bg-blue-500 text-white' 
                      : 'hover:bg-gray-100 dark:hover:bg-white/10 text-gray-600 dark:text-gray-400' %>"
           aria-label="Dashboard (Combined)">
          <span class="w-2 h-2 rounded-full bg-current"></span>
          <span>All</span>
        </a>
        <a href="/movies" 
           class="flex items-center gap-3 px-3 py-2 rounded-lg transition-colors
                  <%= currentPageValue === 'movies' 
                      ? 'bg-blue-500 text-white' 
                      : 'hover:bg-gray-100 dark:hover:bg-white/10 text-gray-600 dark:text-gray-400' %>"
           aria-label="Movies">
          <span class="w-2 h-2 rounded-full bg-current"></span>
          <span>Movies</span>
        </a>
        <a href="/tv" 
           class="flex items-center gap-3 px-3 py-2 rounded-lg transition-colors
                  <%= currentPageValue === 'tv' 
                      ? 'bg-blue-500 text-white' 
                      : 'hover:bg-gray-100 dark:hover:bg-white/10 text-gray-600 dark:text-gray-400' %>"
           aria-label="TV Shows">
          <span class="w-2 h-2 rounded-full bg-current"></span>
          <span>TV Shows</span>
        </a>
      </div>
    </div>
    
    <!-- Other menu items -->
    <% 
      const items = [
        { href: '/data/releases', label: 'Movie Releases', icon: 'movie', page: 'releases' },
        { href: '/data/tv-releases', label: 'TV Releases', icon: 'tv', page: 'tv-releases' },
        { href: '/data/radarr', label: 'Radarr Data', icon: 'database', page: 'radarr' },
        { href: '/data/sonarr', label: 'Sonarr Data', icon: 'database', page: 'sonarr' },
        { href: '/data/rss', label: 'RSS Data', icon: 'rss', page: 'rss' },
        { href: '/logs', label: 'Logs', icon: 'file-text', page: 'logs' },
        { href: '/settings', label: 'Settings', icon: 'settings', page: 'settings' },
      ];
    %>
    
    <% items.forEach(i => { %>
      <a href="<%= i.href %>" 
         class="flex items-center gap-3 px-3 py-2 rounded-lg mb-1 transition-colors
                <%= currentPageValue === i.page 
                    ? 'bg-blue-600 text-white' 
                    : 'hover:bg-gray-100 dark:hover:bg-white/10 text-gray-700 dark:text-gray-300' %>"
         aria-label="<%= i.label %>">
        <span class="w-5 h-5 inline-block flex-shrink-0">
          <i data-icon="<%= i.icon %>"></i>
        </span>
        <span><%= i.label %></span>
      </a>
    <% }) %>
  </nav>

  <div class="absolute bottom-0 w-full px-4 py-3 text-xs text-gray-500 dark:text-gray-400 border-t border-[var(--border)]">
    v1.0.0
  </div>
</aside>

